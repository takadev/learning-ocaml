# OCaml入門

## コメント
(* *)

```
(* コメント *)
```

## 基本の型

 - int      32ビットCPUでは31ビット符号付き整数(およそ±10億)、64ビットCPUでは63ビット符号付き整数
 - float    IEEE倍精度浮動小数点数、Cのdoubleと同じ
 - bool     trueもしくはfalseとなる真偽値
 - char     8bit文字 'a'
 - string   文字列 "foo"
 - unit     ()と書くものCのvoidと似たもの、厳密には違う

## 型変換
OCamlでは暗黙の型変換は一切行われません。

・float_of_int関数
intからfloatへ

・int_of_float関数
floatからintへ

・char_of_int関数
intからcharへ

・int_of_char関数
charからintへ

・string_of_int関数
intからstringへ

・int_of_string関数
stringからintへ


## 四則演算

`+`整数の加算  
`-`整数の減算  
`*`整数の乗算  
`/ `整数の除算  
`mod` 整数除算の剰余  
`+.` 実数の加算  
`-.` 実数の減算  
`*.` 実数の乗算  
`/.` 実数の除算  

```
1 + 2 * 3;;
10 / 2 * 4;;
3.0 +. 2.5;;
5.0 /. 3.0;;
```

## 変数宣言
変数(variable)はlet式で宣言します。

```
let 名前 = 式
```

関数型言語の場合、
バインドされた変数は値を書き換えることができません。

```
let a = 10
let b = 2.0
let c = "foo"
```

## 局所変数
局所変数は「有効範囲(スコープ内)」で使用する変数です。
関数の引数が局所変数にあたります。
また、引数以外にも関数内で変数を使用したい場合は局所変数を定義します。

```
let 変数 = 式1 in
```

```
let sum a b c =
  let ab = a + b in
  ab + c;;
```

## 参照

本当の変数が必要なとき、
つまり代入や変更の値を書き換えたい場合は、
参照型を使います。
参照型はrefで生成します。

```
let a = ref 0;;
a := 10;;
!a;;
```

:=は、参照に代入する演算子で、
!は、参照の内容を取り出す演算子です。


## 関数定義
OCamlは関数もletで定義します。

```
let 名前 引数 = 式
```

letのあとに名前と引数を書き、
=のあとに式を書きます。

```
(* 関数定義 *)
let mul x y = x * y;;
(* 関数呼び出し *)
mul 2 3;;
```

関数型言語の場合、関数もデータ型の一つです。
letで指定したmulは関数型のデータになります。
OCamlは型推論をするので引数や戻り値に型を指定する必要はありません。
戻り値にreturn文も必要なく関数内の最後の式を戻り値とします。
呼び出しの際の括弧や引数の間のカンマも必要ありません。

## 匿名関数
Ocamlは匿名関数も定義できます。

```
fun 引数 -> 式
```

let による関数定義は、匿名関数を用いて表すこともできます。

```
let func = fun 引数 -> 式
```

匿名関数は関数型のデータを生成して返します。
そして、letは変数funcをその値にバインドするだけです。
また、OCamlは匿名関数をそのまま実行することができますし、
関数の引数に匿名関数を渡すこともできます。

```
(fun x -> x * x) 5;;
(fun (x, y) -> x + y) (5, 2);;
func((fun x -> x * x) 5);;
```

## カリー化関数

関数型言語は関数をデータ型の一つとして扱うことができるので、
関数の返り値として関数を返すことができます。
この「関数を返す関数」を使うと、
関数の引数が一つでも複数の引数を処理することができます。
このような関数を「カリー化関数」といいます。

```
fun x -> fun y -> x + y;;
```

この関数は引数を一つだけ与えれば、
関数を返し、引数を2つ与えれば、
それらを加算した結果を返します。
最初の引数を受け取って関数を生成し、
その関数を2番目の引数に適用する、
という動作になります。


## 組(tuple)
OCamlは複数の型を組み合わせて
新しい型を定義することができます。
OCamlの場合、新しい型の定義方法はいくつかあるのですが、
もっとも簡単で重要な方法が
「組(tuple)」です。
組は複数のデータや式をカンマ(,)で区切り、
カッコ()で囲んで表します。

```
let a = (1, 2)
let b = (10, 20.5)
let c = (1, 2.5, "foo")
let d = (1+2, 3*4)

let (a, b) = (1, 2)
let (a, b) = ((1, 2), 3)
let ((c, d), e) = ((1, 2), 3)
```

## リスト
OCamlのリストは「連結リスト(Linked List)」です。
OCamlのリストは複数のデータを格納することができます。
ただし、リストの要素は同じデータ型でなければいけません。
OCamlのリストは、要素をセミコロン(;)で区切り、
角カッコ[]で囲んで表します。

```
let a = [1; 2; 3; 4]
let b = ["abc"; "def"; "ghi"]
let c = [(1, 2); (3, 4); (5, 6)]
let d = [[1]; [2; 3]; [4; 5; 6]]
let e = [1 + 2 + 3; 4 * 5 * 6]
```

